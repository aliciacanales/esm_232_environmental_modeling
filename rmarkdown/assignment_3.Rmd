---
title: "assignment_3"
author: "Alicia Canales and Zoe Zhou"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: cerulean
    code_folding: 'hide'
---

```{r setup, echo = TRUE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
library(tidyverse)
library(here)
```

# Profit model
```{r}
source('../functions/compute_crop_yield.R')
climate_data <- read.table(here('data', 'clim.txt'), header = TRUE)

almond_profit <- compute_profit(climate_data)
```

# Informal Sensitivity Model
```{r}
## 
cost <- rnorm(mean = 7, sd = 0.1, n = 20)
irr <- rnorm(mean = 3, sd = 0.1, n = 20) 

cost_sensitivity <- map(cost, ~compute_profit(climate_data, cost = cost))
head(cost_sensitivity)

cost_sen <- map_df(cost_sensitivity,`[`, c('year', 'profit')) 

ggplot(cost_sen, aes(year, profit, group = year)) +
  geom_boxplot(fill = 'blue') +
  labs(y="Profit of Almond")


irr_sensitivity <- map(cost, ~compute_profit(climate_data, irr = irr))
```

# plots
```{r}

```

